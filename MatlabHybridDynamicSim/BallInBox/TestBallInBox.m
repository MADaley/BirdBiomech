function TestBallInBox
%Run Ball in Box example
% Set parameters
params.g = 9.81;    %gravity
params.m = 1; %the ball weighs 1 kg
params.r = 1; % radius of 1m
params.cor = 0.8; %coefficient of restitution
params.wallXmin = 0;
params.wallXmax = 10;
params.wallYmin = 0;
params.wallYmax = 10;
% params.timeStep = .0001; %time increment produced for plotting output
params.movieTimeStep = 0.025; %time increment used for plotting the movie, >= timeStep

dynamicModel = BuildBallInBox(params);

timeParams.timeLimit = 6;%time limit for simulation
timeParams.timeStep = .01; %time increment produced for plotting output
timeParams.maxNumPhases = 70;%Set number of completed phases in simulation

%Initial Conditions
initialStates(1) = 5; %x position
initialStates(2) = 5; %y position
initialStates(3) = -6.5; %x velocity
initialStates(4) = 10; %y velocity
initialStates=initialStates';
[statesOverTime, phasesOverTime, timeVector, transitions, finalPhaseIndex, exitCode] = RunHybridDynamics(initialStates, dynamicModel, timeParams);

if max(size(transitions))~=7
    error('Number of transitions differs from valid test')
end

test_statesOverTime = ...
    [5.0000    5.0000   -6.5000   10.0000
    4.9350    5.0995   -6.5000    9.9019
    4.8700    5.1980   -6.5000    9.8038
    4.8050    5.2956   -6.5000    9.7057
    4.7400    5.3922   -6.5000    9.6076
    4.6750    5.4877   -6.5000    9.5095
    4.6100    5.5823   -6.5000    9.4114
    4.5450    5.6760   -6.5000    9.3133
    4.4800    5.7686   -6.5000    9.2152
    4.4150    5.8603   -6.5000    9.1171
    4.3500    5.9509   -6.5000    9.0190
    4.2850    6.0406   -6.5000    8.9209
    4.2200    6.1294   -6.5000    8.8228
    4.1550    6.2171   -6.5000    8.7247
    4.0900    6.3039   -6.5000    8.6266
    4.0250    6.3896   -6.5000    8.5285
    3.9600    6.4744   -6.5000    8.4304
    3.8950    6.5582   -6.5000    8.3323
    3.8300    6.6411   -6.5000    8.2342
    3.7650    6.7229   -6.5000    8.1361
    3.7000    6.8038   -6.5000    8.0380
    3.6350    6.8837   -6.5000    7.9399
    3.5700    6.9626   -6.5000    7.8418
    3.5050    7.0405   -6.5000    7.7437
    3.4400    7.1175   -6.5000    7.6456
    3.3750    7.1934   -6.5000    7.5475
    3.3100    7.2684   -6.5000    7.4494
    3.2450    7.3424   -6.5000    7.3513
    3.1800    7.4154   -6.5000    7.2532
    3.1150    7.4875   -6.5000    7.1551
    3.0500    7.5585   -6.5000    7.0570
    2.9850    7.6286   -6.5000    6.9589
    2.9200    7.6977   -6.5000    6.8608
    2.8550    7.7658   -6.5000    6.7627
    2.7900    7.8330   -6.5000    6.6646
    2.7250    7.8991   -6.5000    6.5665
    2.6600    7.9643   -6.5000    6.4684
    2.5950    8.0285   -6.5000    6.3703
    2.5300    8.0917   -6.5000    6.2722
    2.4650    8.1539   -6.5000    6.1741
    2.4000    8.2152   -6.5000    6.0760
    2.3350    8.2755   -6.5000    5.9779
    2.2700    8.3348   -6.5000    5.8798
    2.2050    8.3931   -6.5000    5.7817
    2.1400    8.4504   -6.5000    5.6836
    2.0750    8.5067   -6.5000    5.5855
    2.0100    8.5621   -6.5000    5.4874
    1.9450    8.6165   -6.5000    5.3893
    1.8800    8.6699   -6.5000    5.2912
    1.8150    8.7223   -6.5000    5.1931
    1.7500    8.7737   -6.5000    5.0950
    1.6850    8.8242   -6.5000    4.9969
    1.6200    8.8737   -6.5000    4.8988
    1.5550    8.9222   -6.5000    4.8007
    1.4900    8.9697   -6.5000    4.7026
    1.4250    8.9869   -6.5000   -3.7456
    1.3600    8.9490   -6.5000   -3.8437
    1.2950    8.9100   -6.5000   -3.9418
    1.2300    8.8701   -6.5000   -4.0399
    1.1650    8.8292   -6.5000   -4.1380
    1.1000    8.7874   -6.5000   -4.2361
    1.0350    8.7445   -6.5000   -4.3342
    1.0240    8.7007    5.2000   -4.4323
    1.0760    8.6559    5.2000   -4.5304
    1.1280    8.6101    5.2000   -4.6285
    1.1800    8.5633    5.2000   -4.7266
    1.2320    8.5155    5.2000   -4.8247
    1.2840    8.4668    5.2000   -4.9228
    1.3360    8.4171    5.2000   -5.0209
    1.3880    8.3664    5.2000   -5.1190
    1.4400    8.3147    5.2000   -5.2171
    1.4920    8.2620    5.2000   -5.3152
    1.5440    8.2084    5.2000   -5.4133
    1.5960    8.1538    5.2000   -5.5114
    1.6480    8.0982    5.2000   -5.6095
    1.7000    8.0416    5.2000   -5.7076
    1.7520    7.9840    5.2000   -5.8057
    1.8040    7.9255    5.2000   -5.9038
    1.8560    7.8659    5.2000   -6.0019
    1.9080    7.8054    5.2000   -6.1000
    1.9600    7.7439    5.2000   -6.1981
    2.0120    7.6815    5.2000   -6.2962
    2.0640    7.6180    5.2000   -6.3943
    2.1160    7.5536    5.2000   -6.4924
    2.1680    7.4882    5.2000   -6.5905
    2.2200    7.4218    5.2000   -6.6886
    2.2720    7.3544    5.2000   -6.7867
    2.3240    7.2860    5.2000   -6.8848
    2.3760    7.2167    5.2000   -6.9829
    2.4280    7.1464    5.2000   -7.0810
    2.4800    7.0751    5.2000   -7.1791
    2.5320    7.0028    5.2000   -7.2772
    2.5840    6.9295    5.2000   -7.3753
    2.6360    6.8553    5.2000   -7.4734
    2.6880    6.7801    5.2000   -7.5715
    2.7400    6.7038    5.2000   -7.6696
    2.7920    6.6267    5.2000   -7.7677
    2.8440    6.5485    5.2000   -7.8658
    2.8960    6.4693    5.2000   -7.9639
    2.9480    6.3892    5.2000   -8.0620
    3.0000    6.3081    5.2000   -8.1601
    3.0520    6.2260    5.2000   -8.2582
    3.1040    6.1429    5.2000   -8.3563
    3.1560    6.0589    5.2000   -8.4544
    3.2080    5.9738    5.2000   -8.5525
    3.2600    5.8878    5.2000   -8.6506
    3.3120    5.8008    5.2000   -8.7487
    3.3640    5.7129    5.2000   -8.8468
    3.4160    5.6239    5.2000   -8.9449
    3.4680    5.5340    5.2000   -9.0430
    3.5200    5.4430    5.2000   -9.1411
    3.5720    5.3511    5.2000   -9.2392
    3.6240    5.2583    5.2000   -9.3373
    3.6760    5.1644    5.2000   -9.4354
    3.7280    5.0695    5.2000   -9.5335
    3.7800    4.9737    5.2000   -9.6316
    3.8320    4.8769    5.2000   -9.7297
    3.8840    4.7791    5.2000   -9.8278
    3.9360    4.6804    5.2000   -9.9259
    3.9880    4.5806    5.2000  -10.0240
    4.0400    4.4799    5.2000  -10.1221
    4.0920    4.3782    5.2000  -10.2202
    4.1440    4.2755    5.2000  -10.3183
    4.1960    4.1718    5.2000  -10.4164
    4.2480    4.0671    5.2000  -10.5145
    4.3000    3.9615    5.2000  -10.6126
    4.3520    3.8549    5.2000  -10.7107
    4.4040    3.7473    5.2000  -10.8088
    4.4560    3.6387    5.2000  -10.9069
    4.5080    3.5292    5.2000  -11.0050
    4.5600    3.4186    5.2000  -11.1031
    4.6120    3.3071    5.2000  -11.2012
    4.6640    3.1946    5.2000  -11.2993
    4.7160    3.0811    5.2000  -11.3974
    4.7680    2.9666    5.2000  -11.4955
    4.8200    2.8512    5.2000  -11.5936
    4.8720    2.7348    5.2000  -11.6917
    4.9240    2.6174    5.2000  -11.7898
    4.9760    2.4990    5.2000  -11.8879
    5.0280    2.3796    5.2000  -11.9860
    5.0800    2.2592    5.2000  -12.0841
    5.1320    2.1379    5.2000  -12.1822
    5.1840    2.0156    5.2000  -12.2803
    5.2360    1.8923    5.2000  -12.3784
    5.2880    1.7680    5.2000  -12.4765
    5.3400    1.6428    5.2000  -12.5746
    5.3920    1.5165    5.2000  -12.6727
    5.4440    1.3893    5.2000  -12.7708
    5.4960    1.2611    5.2000  -12.8689
    5.5480    1.1319    5.2000  -12.9670
    5.6000    1.0018    5.2000  -13.0651
    5.6520    1.1026    5.2000   10.3564
    5.7040    1.2057    5.2000   10.2583
    5.7560    1.3078    5.2000   10.1602
    5.8080    1.4089    5.2000   10.0621
    5.8600    1.5090    5.2000    9.9640
    5.9120    1.6082    5.2000    9.8659
    5.9640    1.7064    5.2000    9.7678
    6.0160    1.8035    5.2000    9.6697
    6.0680    1.8997    5.2000    9.5716
    6.1200    1.9950    5.2000    9.4735
    6.1720    2.0892    5.2000    9.3754
    6.2240    2.1825    5.2000    9.2773
    6.2760    2.2748    5.2000    9.1792
    6.3280    2.3661    5.2000    9.0811
    6.3800    2.4564    5.2000    8.9830
    6.4320    2.5457    5.2000    8.8849
    6.4840    2.6341    5.2000    8.7868
    6.5360    2.7215    5.2000    8.6887
    6.5880    2.8079    5.2000    8.5906
    6.6400    2.8933    5.2000    8.4925
    6.6920    2.9777    5.2000    8.3944
    6.7440    3.0612    5.2000    8.2963
    6.7960    3.1436    5.2000    8.1982
    6.8480    3.2251    5.2000    8.1001
    6.9000    3.3056    5.2000    8.0020
    6.9520    3.3852    5.2000    7.9039
    7.0040    3.4637    5.2000    7.8058
    7.0560    3.5413    5.2000    7.7077
    7.1080    3.6179    5.2000    7.6096
    7.1600    3.6935    5.2000    7.5115
    7.2120    3.7681    5.2000    7.4134
    7.2640    3.8417    5.2000    7.3153
    7.3160    3.9144    5.2000    7.2172
    7.3680    3.9861    5.2000    7.1191
    7.4200    4.0568    5.2000    7.0210
    7.4720    4.1265    5.2000    6.9229
    7.5240    4.1953    5.2000    6.8248
    7.5760    4.2630    5.2000    6.7267
    7.6280    4.3298    5.2000    6.6286
    7.6800    4.3956    5.2000    6.5305
    7.7320    4.4604    5.2000    6.4324
    7.7840    4.5242    5.2000    6.3343
    7.8360    4.5871    5.2000    6.2362
    7.8880    4.6490    5.2000    6.1381
    7.9400    4.7098    5.2000    6.0400
    7.9920    4.7698    5.2000    5.9419
    8.0440    4.8287    5.2000    5.8438
    8.0960    4.8866    5.2000    5.7457
    8.1480    4.9436    5.2000    5.6476
    8.2000    4.9996    5.2000    5.5495
    8.2520    5.0546    5.2000    5.4514
    8.3040    5.1086    5.2000    5.3533
    8.3560    5.1617    5.2000    5.2552
    8.4080    5.2137    5.2000    5.1571
    8.4600    5.2648    5.2000    5.0590
    8.5120    5.3149    5.2000    4.9609
    8.5640    5.3640    5.2000    4.8628
    8.6160    5.4122    5.2000    4.7647
    8.6680    5.4593    5.2000    4.6666
    8.7200    5.5055    5.2000    4.5685
    8.7720    5.5507    5.2000    4.4704
    8.8240    5.5949    5.2000    4.3723
    8.8760    5.6381    5.2000    4.2742
    8.9280    5.6804    5.2000    4.1761
    8.9800    5.7216    5.2000    4.0780
    8.9744    5.7619   -4.1600    3.9799
    8.9328    5.8012   -4.1600    3.8818
    8.8912    5.8396   -4.1600    3.7837
    8.8496    5.8769   -4.1600    3.6856
    8.8080    5.9133   -4.1600    3.5875
    8.7664    5.9487   -4.1600    3.4894
    8.7248    5.9831   -4.1600    3.3913
    8.6832    6.0165   -4.1600    3.2932
    8.6416    6.0489   -4.1600    3.1951
    8.6000    6.0804   -4.1600    3.0970
    8.5584    6.1109   -4.1600    2.9989
    8.5168    6.1404   -4.1600    2.9008
    8.4752    6.1689   -4.1600    2.8027
    8.4336    6.1964   -4.1600    2.7046
    8.3920    6.2230   -4.1600    2.6065
    8.3504    6.2486   -4.1600    2.5084
    8.3088    6.2732   -4.1600    2.4103
    8.2672    6.2968   -4.1600    2.3122
    8.2256    6.3194   -4.1600    2.2141
    8.1840    6.3411   -4.1600    2.1160
    8.1424    6.3617   -4.1600    2.0179
    8.1008    6.3814   -4.1600    1.9198
    8.0592    6.4001   -4.1600    1.8217
    8.0176    6.4178   -4.1600    1.7236
    7.9760    6.4346   -4.1600    1.6255
    7.9344    6.4504   -4.1600    1.5274
    7.8928    6.4651   -4.1600    1.4293
    7.8512    6.4789   -4.1600    1.3312
    7.8096    6.4918   -4.1600    1.2331
    7.7680    6.5036   -4.1600    1.1350
    7.7264    6.5145   -4.1600    1.0369
    7.6848    6.5243   -4.1600    0.9388
    7.6432    6.5332   -4.1600    0.8407
    7.6016    6.5412   -4.1600    0.7426
    7.5600    6.5481   -4.1600    0.6445
    7.5184    6.5540   -4.1600    0.5464
    7.4768    6.5590   -4.1600    0.4483
    7.4352    6.5630   -4.1600    0.3502
    7.3936    6.5660   -4.1600    0.2521
    7.3520    6.5681   -4.1600    0.1540
    7.3104    6.5691   -4.1600    0.0559
    7.2688    6.5692   -4.1600   -0.0422
    7.2272    6.5683   -4.1600   -0.1403
    7.1856    6.5664   -4.1600   -0.2384
    7.1440    6.5635   -4.1600   -0.3365
    7.1024    6.5596   -4.1600   -0.4346
    7.0608    6.5548   -4.1600   -0.5327
    7.0192    6.5490   -4.1600   -0.6308
    6.9776    6.5422   -4.1600   -0.7289
    6.9360    6.5344   -4.1600   -0.8270
    6.8944    6.5256   -4.1600   -0.9251
    6.8528    6.5159   -4.1600   -1.0232
    6.8112    6.5052   -4.1600   -1.1213
    6.7696    6.4935   -4.1600   -1.2194
    6.7280    6.4808   -4.1600   -1.3175
    6.6864    6.4671   -4.1600   -1.4156
    6.6448    6.4525   -4.1600   -1.5137
    6.6032    6.4369   -4.1600   -1.6118
    6.5616    6.4202   -4.1600   -1.7099
    6.5200    6.4027   -4.1600   -1.8080
    6.4784    6.3841   -4.1600   -1.9061
    6.4368    6.3645   -4.1600   -2.0042
    6.3952    6.3440   -4.1600   -2.1023
    6.3536    6.3225   -4.1600   -2.2004
    6.3120    6.3000   -4.1600   -2.2985
    6.2704    6.2765   -4.1600   -2.3966
    6.2288    6.2521   -4.1600   -2.4947
    6.1872    6.2266   -4.1600   -2.5928
    6.1456    6.2002   -4.1600   -2.6909
    6.1040    6.1728   -4.1600   -2.7890
    6.0624    6.1444   -4.1600   -2.8871
    6.0208    6.1151   -4.1600   -2.9852
    5.9792    6.0847   -4.1600   -3.0833
    5.9376    6.0534   -4.1600   -3.1814
    5.8960    6.0211   -4.1600   -3.2795
    5.8544    5.9878   -4.1600   -3.3776
    5.8128    5.9535   -4.1600   -3.4757
    5.7712    5.9183   -4.1600   -3.5738
    5.7296    5.8821   -4.1600   -3.6719
    5.6880    5.8449   -4.1600   -3.7700
    5.6464    5.8067   -4.1600   -3.8681
    5.6048    5.7675   -4.1600   -3.9662
    5.5632    5.7274   -4.1600   -4.0643
    5.5216    5.6862   -4.1600   -4.1624
    5.4800    5.6441   -4.1600   -4.2605
    5.4384    5.6010   -4.1600   -4.3586
    5.3968    5.5569   -4.1600   -4.4567
    5.3552    5.5119   -4.1600   -4.5548
    5.3136    5.4658   -4.1600   -4.6529
    5.2720    5.4188   -4.1600   -4.7510
    5.2304    5.3708   -4.1600   -4.8491
    5.1888    5.3218   -4.1600   -4.9472
    5.1472    5.2719   -4.1600   -5.0453
    5.1056    5.2209   -4.1600   -5.1434
    5.0640    5.1690   -4.1600   -5.2415
    5.0224    5.1161   -4.1600   -5.3396
    4.9808    5.0622   -4.1600   -5.4377
    4.9392    5.0073   -4.1600   -5.5358
    4.8976    4.9515   -4.1600   -5.6339
    4.8560    4.8947   -4.1600   -5.7320
    4.8144    4.8369   -4.1600   -5.8301
    4.7728    4.7781   -4.1600   -5.9282
    4.7312    4.7183   -4.1600   -6.0263
    4.6896    4.6575   -4.1600   -6.1244
    4.6480    4.5958   -4.1600   -6.2225
    4.6064    4.5331   -4.1600   -6.3206
    4.5648    4.4694   -4.1600   -6.4187
    4.5232    4.4047   -4.1600   -6.5168
    4.4816    4.3391   -4.1600   -6.6149
    4.4400    4.2724   -4.1600   -6.7130
    4.3984    4.2048   -4.1600   -6.8111
    4.3568    4.1362   -4.1600   -6.9092
    4.3152    4.0666   -4.1600   -7.0073
    4.2736    3.9961   -4.1600   -7.1054
    4.2320    3.9245   -4.1600   -7.2035
    4.1904    3.8520   -4.1600   -7.3016
    4.1488    3.7785   -4.1600   -7.3997
    4.1072    3.7040   -4.1600   -7.4978
    4.0656    3.6285   -4.1600   -7.5959
    4.0240    3.5521   -4.1600   -7.6940
    3.9824    3.4746   -4.1600   -7.7921
    3.9408    3.3962   -4.1600   -7.8902
    3.8992    3.3168   -4.1600   -7.9883
    3.8576    3.2365   -4.1600   -8.0864
    3.8160    3.1551   -4.1600   -8.1845
    3.7744    3.0728   -4.1600   -8.2826
    3.7328    2.9895   -4.1600   -8.3807
    3.6912    2.9052   -4.1600   -8.4788
    3.6496    2.8199   -4.1600   -8.5769
    3.6080    2.7336   -4.1600   -8.6750
    3.5664    2.6464   -4.1600   -8.7731
    3.5248    2.5582   -4.1600   -8.8712
    3.4832    2.4690   -4.1600   -8.9693
    3.4416    2.3788   -4.1600   -9.0674
    3.4000    2.2876   -4.1600   -9.1655
    3.3584    2.1955   -4.1600   -9.2636
    3.3168    2.1023   -4.1600   -9.3617
    3.2752    2.0082   -4.1600   -9.4598
    3.2336    1.9131   -4.1600   -9.5579
    3.1920    1.8171   -4.1600   -9.6560
    3.1504    1.7200   -4.1600   -9.7541
    3.1088    1.6220   -4.1600   -9.8522
    3.0672    1.5230   -4.1600   -9.9503
    3.0256    1.4230   -4.1600  -10.0484
    2.9840    1.3220   -4.1600  -10.1465
    2.9424    1.2201   -4.1600  -10.2446
    2.9008    1.1171   -4.1600  -10.3427
    2.8592    1.0132   -4.1600  -10.4408
    2.8176    1.0727   -4.1600    8.2768
    2.7760    1.1550   -4.1600    8.1787
    2.7344    1.2363   -4.1600    8.0806
    2.6928    1.3166   -4.1600    7.9825
    2.6512    1.3959   -4.1600    7.8844
    2.6096    1.4743   -4.1600    7.7863
    2.5680    1.5516   -4.1600    7.6882
    2.5264    1.6280   -4.1600    7.5901
    2.4848    1.7034   -4.1600    7.4920
    2.4432    1.7779   -4.1600    7.3939
    2.4016    1.8513   -4.1600    7.2958
    2.3600    1.9238   -4.1600    7.1977
    2.3184    1.9953   -4.1600    7.0996
    2.2768    2.0658   -4.1600    7.0015
    2.2352    2.1353   -4.1600    6.9034
    2.1936    2.2038   -4.1600    6.8053
    2.1520    2.2714   -4.1600    6.7072
    2.1104    2.3380   -4.1600    6.6091
    2.0688    2.4036   -4.1600    6.5110
    2.0272    2.4682   -4.1600    6.4129
    1.9856    2.5318   -4.1600    6.3148
    1.9440    2.5945   -4.1600    6.2167
    1.9024    2.6562   -4.1600    6.1186
    1.8608    2.7169   -4.1600    6.0205
    1.8192    2.7766   -4.1600    5.9224
    1.7776    2.8353   -4.1600    5.8243
    1.7360    2.8931   -4.1600    5.7262
    1.6944    2.9499   -4.1600    5.6281
    1.6528    3.0056   -4.1600    5.5300
    1.6112    3.0605   -4.1600    5.4319
    1.5696    3.1143   -4.1600    5.3338
    1.5280    3.1671   -4.1600    5.2357
    1.4864    3.2190   -4.1600    5.1376
    1.4448    3.2699   -4.1600    5.0395
    1.4032    3.3198   -4.1600    4.9414
    1.3616    3.3687   -4.1600    4.8433
    1.3200    3.4167   -4.1600    4.7452
    1.2784    3.4636   -4.1600    4.6471
    1.2368    3.5096   -4.1600    4.5490
    1.1952    3.5546   -4.1600    4.4509
    1.1536    3.5986   -4.1600    4.3528
    1.1120    3.6417   -4.1600    4.2547
    1.0704    3.6837   -4.1600    4.1566
    1.0288    3.7248   -4.1600    4.0585
    1.0102    3.7649    3.3280    3.9604
    1.0435    3.8040    3.3280    3.8623
    1.0768    3.8421    3.3280    3.7642
    1.1101    3.8793    3.3280    3.6661
    1.1434    3.9155    3.3280    3.5680
    1.1766    3.9506    3.3280    3.4699
    1.2099    3.9849    3.3280    3.3718
    1.2432    4.0181    3.3280    3.2737
    1.2765    4.0503    3.3280    3.1756
    1.3098    4.0816    3.3280    3.0775
    1.3430    4.1119    3.3280    2.9794
    1.3763    4.1412    3.3280    2.8813
    1.4096    4.1695    3.3280    2.7832
    1.4429    4.1968    3.3280    2.6851
    1.4762    4.2232    3.3280    2.5870
    1.5094    4.2486    3.3280    2.4889
    1.5427    4.2730    3.3280    2.3908
    1.5760    4.2964    3.3280    2.2927
    1.6093    4.3188    3.3280    2.1946
    1.6426    4.3403    3.3280    2.0965
    1.6758    4.3608    3.3280    1.9984
    1.7091    4.3803    3.3280    1.9003
    1.7424    4.3988    3.3280    1.8022
    1.7757    4.4163    3.3280    1.7041
    1.8090    4.4329    3.3280    1.6060
    1.8422    4.4484    3.3280    1.5079
    1.8755    4.4630    3.3280    1.4098
    1.9088    4.4766    3.3280    1.3117
    1.9421    4.4893    3.3280    1.2136
    1.9754    4.5009    3.3280    1.1155
    2.0086    4.5116    3.3280    1.0174
    2.0419    4.5213    3.3280    0.9193
    2.0752    4.5300    3.3280    0.8212
    2.1085    4.5377    3.3280    0.7231
    2.1418    4.5444    3.3280    0.6250
    2.1750    4.5502    3.3280    0.5269
    2.2083    4.5550    3.3280    0.4288
    2.2416    4.5588    3.3280    0.3307
    2.2749    4.5616    3.3280    0.2326
    2.3082    4.5634    3.3280    0.1345
    2.3414    4.5643    3.3280    0.0364
    2.3747    4.5641    3.3280   -0.0617
    2.4080    4.5630    3.3280   -0.1598
    2.4413    4.5609    3.3280   -0.2579
    2.4746    4.5579    3.3280   -0.3560
    2.5078    4.5538    3.3280   -0.4541
    2.5411    4.5488    3.3280   -0.5522
    2.5744    4.5428    3.3280   -0.6503
    2.6077    4.5358    3.3280   -0.7484
    2.6410    4.5278    3.3280   -0.8465
    2.6742    4.5189    3.3280   -0.9446
    2.7075    4.5089    3.3280   -1.0427
    2.7408    4.4980    3.3280   -1.1408
    2.7741    4.4861    3.3280   -1.2389
    2.8074    4.4732    3.3280   -1.3370
    2.8406    4.4594    3.3280   -1.4351
    2.8739    4.4445    3.3280   -1.5332
    2.9072    4.4287    3.3280   -1.6313
    2.9405    4.4119    3.3280   -1.7294
    2.9738    4.3941    3.3280   -1.8275
    3.0070    4.3754    3.3280   -1.9256
    3.0403    4.3556    3.3280   -2.0237
    3.0736    4.3349    3.3280   -2.1218
    3.1069    4.3132    3.3280   -2.2199
    3.1402    4.2905    3.3280   -2.3180
    3.1734    4.2668    3.3280   -2.4161
    3.2067    4.2422    3.3280   -2.5142
    3.2400    4.2165    3.3280   -2.6123
    3.2733    4.1899    3.3280   -2.7104
    3.3066    4.1623    3.3280   -2.8085
    3.3398    4.1337    3.3280   -2.9066
    3.3731    4.1042    3.3280   -3.0047
    3.4064    4.0737    3.3280   -3.1028
    3.4397    4.0421    3.3280   -3.2009
    3.4730    4.0096    3.3280   -3.2990
    3.5062    3.9762    3.3280   -3.3971
    3.5395    3.9417    3.3280   -3.4952
    3.5728    3.9063    3.3280   -3.5933
    3.6061    3.8698    3.3280   -3.6914
    3.6394    3.8324    3.3280   -3.7895
    3.6726    3.7940    3.3280   -3.8876
    3.7059    3.7547    3.3280   -3.9857
    3.7392    3.7143    3.3280   -4.0838
    3.7725    3.6730    3.3280   -4.1819
    3.8058    3.6307    3.3280   -4.2800
    3.8390    3.5874    3.3280   -4.3781
    3.8723    3.5431    3.3280   -4.4762
    3.9056    3.4979    3.3280   -4.5743
    3.9389    3.4516    3.3280   -4.6724
    3.9722    3.4044    3.3280   -4.7705
    4.0054    3.3562    3.3280   -4.8686
    4.0387    3.3071    3.3280   -4.9667
    4.0720    3.2569    3.3280   -5.0648
    4.1053    3.2058    3.3280   -5.1629
    4.1386    3.1536    3.3280   -5.2610
    4.1718    3.1005    3.3280   -5.3591
    4.2051    3.0465    3.3280   -5.4572
    4.2384    2.9914    3.3280   -5.5553
    4.2717    2.9354    3.3280   -5.6534
    4.3050    2.8783    3.3280   -5.7515
    4.3382    2.8203    3.3280   -5.8496
    4.3715    2.7613    3.3280   -5.9477
    4.4048    2.7014    3.3280   -6.0458
    4.4381    2.6404    3.3280   -6.1439
    4.4714    2.5785    3.3280   -6.2420
    4.5046    2.5156    3.3280   -6.3401
    4.5379    2.4517    3.3280   -6.4382
    4.5712    2.3868    3.3280   -6.5363
    4.6045    2.3210    3.3280   -6.6344
    4.6378    2.2541    3.3280   -6.7325
    4.6710    2.1863    3.3280   -6.8306
    4.7043    2.1175    3.3280   -6.9287
    4.7376    2.0478    3.3280   -7.0268
    4.7709    1.9770    3.3280   -7.1249
    4.8042    1.9053    3.3280   -7.2230
    4.8374    1.8325    3.3280   -7.3211
    4.8707    1.7588    3.3280   -7.4192
    4.9040    1.6842    3.3280   -7.5173
    4.9373    1.6085    3.3280   -7.6154
    4.9706    1.5318    3.3280   -7.7135
    5.0038    1.4542    3.3280   -7.8116
    5.0371    1.3756    3.3280   -7.9097
    5.0704    1.2960    3.3280   -8.0078
    5.1037    1.2155    3.3280   -8.1059
    5.1370    1.1339    3.3280   -8.2040
    5.1702    1.0514    3.3280   -8.3021
    5.2035    1.0256    3.3280    6.6524
    5.2368    1.0916    3.3280    6.5543
    5.2701    1.1567    3.3280    6.4562
    5.3034    1.2207    3.3280    6.3581
    5.3366    1.2838    3.3280    6.2600
    5.3699    1.3459    3.3280    6.1619
    5.4032    1.4071    3.3280    6.0638
    5.4365    1.4672    3.3280    5.9657
    5.4698    1.5264    3.3280    5.8676
    5.5030    1.5846    3.3280    5.7695
    5.5363    1.6418    3.3280    5.6714
    5.5696    1.6980    3.3280    5.5733
    5.6029    1.7532    3.3280    5.4752
    5.6362    1.8075    3.3280    5.3771
    5.6694    1.8608    3.3280    5.2790
    5.7027    1.9131    3.3280    5.1809
    5.7360    1.9644    3.3280    5.0828
    5.7693    2.0147    3.3280    4.9847
    5.8026    2.0641    3.3280    4.8866
    5.8358    2.1125    3.3280    4.7885
    5.8691    2.1599    3.3280    4.6904
    5.9024    2.2063    3.3280    4.5923
    5.9357    2.2517    3.3280    4.4942
    5.9690    2.2962    3.3280    4.3961
    6.0022    2.3396    3.3280    4.2980
    6.0355    2.3821    3.3280    4.1999
    6.0688    2.4236    3.3280    4.1018
    6.1021    2.4642    3.3280    4.0037
    6.1354    2.5037    3.3280    3.9056
    6.1686    2.5423    3.3280    3.8075
    6.2019    2.5799    3.3280    3.7094
    6.2352    2.6165    3.3280    3.6113
    6.2685    2.6521    3.3280    3.5132
    6.3018    2.6867    3.3280    3.4151
    6.3350    2.7204    3.3280    3.3170
    6.3683    2.7531    3.3280    3.2189
    6.4016    2.7848    3.3280    3.1208
    6.4349    2.8155    3.3280    3.0227
    6.4682    2.8452    3.3280    2.9246
    6.5014    2.8740    3.3280    2.8265
    6.5347    2.9017    3.3280    2.7284
    6.5680    2.9285    3.3280    2.6303
    6.6013    2.9544    3.3280    2.5322
    6.6346    2.9792    3.3280    2.4341
    6.6678    3.0030    3.3280    2.3360
    6.7011    3.0259    3.3280    2.2379
    6.7344    3.0478    3.3280    2.1398
    6.7677    3.0687    3.3280    2.0417
    6.8010    3.0886    3.3280    1.9436
    6.8342    3.1076    3.3280    1.8455
    6.8675    3.1255    3.3280    1.7474
    6.9008    3.1425    3.3280    1.6493
    6.9341    3.1585    3.3280    1.5512
    6.9674    3.1735    3.3280    1.4531
    7.0006    3.1876    3.3280    1.3550
    7.0339    3.2006    3.3280    1.2569
    7.0672    3.2127    3.3280    1.1588
    7.1005    3.2238    3.3280    1.0607
    7.1338    3.2339    3.3280    0.9626
    7.1670    3.2431    3.3280    0.8645
    7.2003    3.2512    3.3280    0.7664
    7.2336    3.2584    3.3280    0.6683
    7.2669    3.2646    3.3280    0.5702
    7.3002    3.2698    3.3280    0.4721
    7.3334    3.2740    3.3280    0.3740
    7.3667    3.2773    3.3280    0.2759
    7.4000    3.2796    3.3280    0.1778]';

test_phasesOverTime = ones(size(timeVector));

test_timeVector =...
    [0
    0.0100
    0.0200
    0.0300
    0.0400
    0.0500
    0.0600
    0.0700
    0.0800
    0.0900
    0.1000
    0.1100
    0.1200
    0.1300
    0.1400
    0.1500
    0.1600
    0.1700
    0.1800
    0.1900
    0.2000
    0.2100
    0.2200
    0.2300
    0.2400
    0.2500
    0.2600
    0.2700
    0.2800
    0.2900
    0.3000
    0.3100
    0.3200
    0.3300
    0.3400
    0.3500
    0.3600
    0.3700
    0.3800
    0.3900
    0.4000
    0.4100
    0.4200
    0.4300
    0.4400
    0.4500
    0.4600
    0.4700
    0.4800
    0.4900
    0.5000
    0.5100
    0.5200
    0.5300
    0.5400
    0.5500
    0.5600
    0.5700
    0.5800
    0.5900
    0.6000
    0.6100
    0.6200
    0.6300
    0.6400
    0.6500
    0.6600
    0.6700
    0.6800
    0.6900
    0.7000
    0.7100
    0.7200
    0.7300
    0.7400
    0.7500
    0.7600
    0.7700
    0.7800
    0.7900
    0.8000
    0.8100
    0.8200
    0.8300
    0.8400
    0.8500
    0.8600
    0.8700
    0.8800
    0.8900
    0.9000
    0.9100
    0.9200
    0.9300
    0.9400
    0.9500
    0.9600
    0.9700
    0.9800
    0.9900
    1.0000
    1.0100
    1.0200
    1.0300
    1.0400
    1.0500
    1.0600
    1.0700
    1.0800
    1.0900
    1.1000
    1.1100
    1.1200
    1.1300
    1.1400
    1.1500
    1.1600
    1.1700
    1.1800
    1.1900
    1.2000
    1.2100
    1.2200
    1.2300
    1.2400
    1.2500
    1.2600
    1.2700
    1.2800
    1.2900
    1.3000
    1.3100
    1.3200
    1.3300
    1.3400
    1.3500
    1.3600
    1.3700
    1.3800
    1.3900
    1.4000
    1.4100
    1.4200
    1.4300
    1.4400
    1.4500
    1.4600
    1.4700
    1.4800
    1.4900
    1.5000
    1.5100
    1.5200
    1.5300
    1.5400
    1.5500
    1.5600
    1.5700
    1.5800
    1.5900
    1.6000
    1.6100
    1.6200
    1.6300
    1.6400
    1.6500
    1.6600
    1.6700
    1.6800
    1.6900
    1.7000
    1.7100
    1.7200
    1.7300
    1.7400
    1.7500
    1.7600
    1.7700
    1.7800
    1.7900
    1.8000
    1.8100
    1.8200
    1.8300
    1.8400
    1.8500
    1.8600
    1.8700
    1.8800
    1.8900
    1.9000
    1.9100
    1.9200
    1.9300
    1.9400
    1.9500
    1.9600
    1.9700
    1.9800
    1.9900
    2.0000
    2.0100
    2.0200
    2.0300
    2.0400
    2.0500
    2.0600
    2.0700
    2.0800
    2.0900
    2.1000
    2.1100
    2.1200
    2.1300
    2.1400
    2.1500
    2.1600
    2.1700
    2.1800
    2.1900
    2.2000
    2.2100
    2.2200
    2.2300
    2.2400
    2.2500
    2.2600
    2.2700
    2.2800
    2.2900
    2.3000
    2.3100
    2.3200
    2.3300
    2.3400
    2.3500
    2.3600
    2.3700
    2.3800
    2.3900
    2.4000
    2.4100
    2.4200
    2.4300
    2.4400
    2.4500
    2.4600
    2.4700
    2.4800
    2.4900
    2.5000
    2.5100
    2.5200
    2.5300
    2.5400
    2.5500
    2.5600
    2.5700
    2.5800
    2.5900
    2.6000
    2.6100
    2.6200
    2.6300
    2.6400
    2.6500
    2.6600
    2.6700
    2.6800
    2.6900
    2.7000
    2.7100
    2.7200
    2.7300
    2.7400
    2.7500
    2.7600
    2.7700
    2.7800
    2.7900
    2.8000
    2.8100
    2.8200
    2.8300
    2.8400
    2.8500
    2.8600
    2.8700
    2.8800
    2.8900
    2.9000
    2.9100
    2.9200
    2.9300
    2.9400
    2.9500
    2.9600
    2.9700
    2.9800
    2.9900
    3.0000
    3.0100
    3.0200
    3.0300
    3.0400
    3.0500
    3.0600
    3.0700
    3.0800
    3.0900
    3.1000
    3.1100
    3.1200
    3.1300
    3.1400
    3.1500
    3.1600
    3.1700
    3.1800
    3.1900
    3.2000
    3.2100
    3.2200
    3.2300
    3.2400
    3.2500
    3.2600
    3.2700
    3.2800
    3.2900
    3.3000
    3.3100
    3.3200
    3.3300
    3.3400
    3.3500
    3.3600
    3.3700
    3.3800
    3.3900
    3.4000
    3.4100
    3.4200
    3.4300
    3.4400
    3.4500
    3.4600
    3.4700
    3.4800
    3.4900
    3.5000
    3.5100
    3.5200
    3.5300
    3.5400
    3.5500
    3.5600
    3.5700
    3.5800
    3.5900
    3.6000
    3.6100
    3.6200
    3.6300
    3.6400
    3.6500
    3.6600
    3.6700
    3.6800
    3.6900
    3.7000
    3.7100
    3.7200
    3.7300
    3.7400
    3.7500
    3.7600
    3.7700
    3.7800
    3.7900
    3.8000
    3.8100
    3.8200
    3.8300
    3.8400
    3.8500
    3.8600
    3.8700
    3.8800
    3.8900
    3.9000
    3.9100
    3.9200
    3.9300
    3.9400
    3.9500
    3.9600
    3.9700
    3.9800
    3.9900
    4.0000
    4.0100
    4.0200
    4.0300
    4.0400
    4.0500
    4.0600
    4.0700
    4.0800
    4.0900
    4.1000
    4.1100
    4.1200
    4.1300
    4.1400
    4.1500
    4.1600
    4.1700
    4.1800
    4.1900
    4.2000
    4.2100
    4.2200
    4.2300
    4.2400
    4.2500
    4.2600
    4.2700
    4.2800
    4.2900
    4.3000
    4.3100
    4.3200
    4.3300
    4.3400
    4.3500
    4.3600
    4.3700
    4.3800
    4.3900
    4.4000
    4.4100
    4.4200
    4.4300
    4.4400
    4.4500
    4.4600
    4.4700
    4.4800
    4.4900
    4.5000
    4.5100
    4.5200
    4.5300
    4.5400
    4.5500
    4.5600
    4.5700
    4.5800
    4.5900
    4.6000
    4.6100
    4.6200
    4.6300
    4.6400
    4.6500
    4.6600
    4.6700
    4.6800
    4.6900
    4.7000
    4.7100
    4.7200
    4.7300
    4.7400
    4.7500
    4.7600
    4.7700
    4.7800
    4.7900
    4.8000
    4.8100
    4.8200
    4.8300
    4.8400
    4.8500
    4.8600
    4.8700
    4.8800
    4.8900
    4.9000
    4.9100
    4.9200
    4.9300
    4.9400
    4.9500
    4.9600
    4.9700
    4.9800
    4.9900
    5.0000
    5.0100
    5.0200
    5.0300
    5.0400
    5.0500
    5.0600
    5.0700
    5.0800
    5.0900
    5.1000
    5.1100
    5.1200
    5.1300
    5.1400
    5.1500
    5.1600
    5.1700
    5.1800
    5.1900
    5.2000
    5.2100
    5.2200
    5.2300
    5.2400
    5.2500
    5.2600
    5.2700
    5.2800
    5.2900
    5.3000
    5.3100
    5.3200
    5.3300
    5.3400
    5.3500
    5.3600
    5.3700
    5.3800
    5.3900
    5.4000
    5.4100
    5.4200
    5.4300
    5.4400
    5.4500
    5.4600
    5.4700
    5.4800
    5.4900
    5.5000
    5.5100
    5.5200
    5.5300
    5.5400
    5.5500
    5.5600
    5.5700
    5.5800
    5.5900
    5.6000
    5.6100
    5.6200
    5.6300
    5.6400
    5.6500
    5.6600
    5.6700
    5.6800
    5.6900
    5.7000
    5.7100
    5.7200
    5.7300
    5.7400
    5.7500
    5.7600
    5.7700
    5.7800
    5.7900
    5.8000
    5.8100
    5.8200
    5.8300
    5.8400
    5.8500
    5.8600
    5.8700
    5.8800
    5.8900
    5.9000
    5.9100
    5.9200
    5.9300
    5.9400
    5.9500
    5.9600
    5.9700
    5.9800
    5.9900
    6.0000];

for i = 1:max(size(transitions))
    trans_1(i) = transitions{i}{1};
    trans_2(i,:) = transitions{i}{2}';
    trans_3(i,:) = transitions{i}{3}';
    trans_4(i) = transitions{i}{4};
end

test_trans_1 = [0.5465    0.6154    1.5001    2.1538    3.6313    4.0769    5.3362];

test_trans_2 =...
    [1.4478    9.0000   -6.5000    4.6390
    1.0000    8.7210   -6.5000   -4.3871
    5.6007    1.0000    5.2000  -13.0665
    9.0000    5.7373    5.2000    4.0403
    2.8539    1.0000   -4.1600  -10.4532
    1.0000    3.7527   -4.1600    3.9906
    5.1908    1.0000    3.3280   -8.3625];


test_trans_3 =...
    [1.4478    9.0000   -6.5000   -3.7112
    1.0000    8.7210    5.2000   -4.3871
    5.6007    1.0000    5.2000   10.4532
    9.0000    5.7373   -4.1600    4.0403
    2.8539    1.0000   -4.1600    8.3625
    1.0000    3.7527    3.3280    3.9906
    5.1908    1.0000    3.3280    6.6900];

test_trans_4 = [4     1     3     2     3     1     3];

test_finalPhaseIndex = 1;
test_exitCode = -1;

phaseError= sum((test_phasesOverTime-phasesOverTime).^2);
timeError = sum((test_timeVector-timeVector).^2);
statesError = sum(((test_statesOverTime-statesOverTime).^2),2);
transError1 = sum(((test_trans_1-trans_1).^2),2);
transError2 = sum(((test_trans_2-trans_2).^2),2);
transError3 = sum(((test_trans_3-trans_3).^2),2);
transError4 = sum(((test_trans_4-trans_4).^2),2);
finalPhaseError = sum(((test_finalPhaseIndex-finalPhaseIndex).^2),2);
exitCodeError = sum(((test_exitCode-exitCode).^2),2);

if phaseError > 0.00001
    error('PhasesOverTime matrix differs from valid test case')
elseif timeError > 0.00001
    error('timeVector differs from valid test case')
elseif any(statesError > 0.00001)
    error('statesOverTime differs from valid test case')
elseif transError1 > 0.00001
    error('First component of transitions array (transition time) differs from valid test case')
elseif any(transError2 > 0.00001)
    error('Second component of transitions array (phase end states) differs from valid test case')
elseif any(transError3 > 0.00001)
    error('Third component of transitions array (state after transition) differs from valid test case')
elseif transError4 > 0.00001
    error('Fourth component of transitions array (event index) differs from valid test case')
elseif finalPhaseError > 0
    error('finalPhaseIndex differs from valid test case')
elseif exitCodeError > 0
    error('exitCode differs from valid test case')
else
    disp('BallInBox test succesful.')
end

